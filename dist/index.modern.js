import{AppContainer as t}from"react-hot-loader";import e from"react";import o from"react-dom";import r from"lodash";import{join as n,relative as i}from"path";import{readdirSync as a,statSync as c}from"fs";import{merge as s}from"webpack-merge";import l from"webpack";const p={},u={init:function(t,e){window.ReactRailsUJS.mountComponents=u.mountComponents,t.hot&&t.hot.accept(u.hmrModules(),t=>{u.fixDeps(t).forEach(t=>e(t)),window.ReactRailsUJS.mountComponents()})},fixDeps:function(t){return r(t).flatten().uniq().value()},hmrModules:function(){return HMR_MODULES.map(t=>require.context("../").resolve(t))},mountComponents:function(r){let n=window.ReactRailsUJS,i=n.findDOMNodes(r);for(let r=0;r<i.length;++r){let a=i[r],c=a.getAttribute(n.CLASS_NAME_ATTR),s=n.getConstructor(c),l=a.getAttribute(n.PROPS_ATTR),u=l&&JSON.parse(l),m=a.getAttribute(n.RENDER_ATTR),f=a.getAttribute(n.CACHE_ID_ATTR),h=a.hasAttribute(n.TURBOLINKS_PERMANENT_ATTR);if(!s){let t="Cannot find component: '"+c+"'";throw console&&console.log&&console.log("%c[react-rails] %c"+t+" for element","font-weight: bold","",a),new Error(t+". Make sure your component is available to render.")}{let r=p[f];void 0===r&&(r=e.createElement(s,u),h&&(p[f]=r)),m&&"function"==typeof o.hydrate?o.hydrate(e.createElement(t,{},r),a):o.render(e.createElement(t,{},r),a)}}}};class m{constructor(t){this.webpackConfig=t}walkSync(t,e=[]){return a(t).forEach(o=>{const r=n(t,o);r.includes(".DS_Store")||r.includes("packs")||(c(r).isDirectory()?e=this.walkSync(r,e):e.push("./"+i("app/javascript",r)))}),e}packFiles(){return this.walkSync("app/javascript")}entries(){return Object.keys(this.webpackConfig.entry).reduce((t,e)=>(t[e]=["react-hot-loader/patch",this.webpackConfig.entry[e]],t),{})}reactRailsHotReloadConfig(){return{devtool:"cheap-eval-source-map",entry:this.entries(),output:{publicPath:"http://localhost:3035/packs/"},plugins:[new l.DefinePlugin({HMR_MODULES:JSON.stringify(this.packFiles())})],resolve:{alias:{"react-dom":"@hot-loader/react-dom"}},watch:!1}}merge(t){return this.webpackConfig=t,s(this.webpackConfig,this.reactRailsHotReloadConfig())}}export{u as ReactRailsHotReload,m as ReactRailsHotReloadConfig};
//# sourceMappingURL=index.modern.js.map

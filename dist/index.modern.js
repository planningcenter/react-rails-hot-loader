import{AppContainer as t}from"react-hot-loader";import e from"react";import o from"react-dom";import r from"lodash";import{join as a,relative as i}from"path";import{readdirSync as n,statSync as s}from"fs";import{merge as c}from"webpack-merge";import l from"webpack";const p={};class u{static init(t,e){window.ReactRailsUJS.mountComponents=u.mountComponents,t.hot&&t.hot.accept(u.hmrModules(),t=>{u.fixDeps(t).forEach(t=>e(t)),window.ReactRailsUJS.mountComponents()})}static fixDeps(t){return r(t).flatten().uniq().value()}static hmrModules(){return HMR_MODULES.map(t=>require.context("../").resolve(t))}static mountComponents(r){let a=window.ReactRailsUJS,i=a.findDOMNodes(r);for(let r=0;r<i.length;++r){let n=i[r],s=n.getAttribute(a.CLASS_NAME_ATTR),c=a.getConstructor(s),l=n.getAttribute(a.PROPS_ATTR),u=l&&JSON.parse(l),m=n.getAttribute(a.RENDER_ATTR),f=n.getAttribute(a.CACHE_ID_ATTR),d=n.hasAttribute(a.TURBOLINKS_PERMANENT_ATTR);if(!c){let t="Cannot find component: '"+s+"'";throw console&&console.log&&console.log("%c[react-rails] %c"+t+" for element","font-weight: bold","",n),new Error(t+". Make sure your component is available to render.")}{let r=p[f];void 0===r&&(r=e.createElement(c,u),d&&(p[f]=r)),m&&"function"==typeof o.hydrate?o.hydrate(h(t,null,r),n):o.render(h(t,null,r),n)}}}}class m{constructor(t){this.webpackConfig=t}walkSync(t,e=[]){return n(t).forEach(o=>{const r=a(t,o);r.includes(".DS_Store")||r.includes("packs")||(s(r).isDirectory()?e=this.walkSync(r,e):e.push("./"+i("app/javascript",r)))}),e}packFiles(){return this.walkSync("app/javascript")}entries(){return Object.keys(this.webpackConfig.entry).reduce((t,e)=>(t[e]=["react-hot-loader/patch",this.webpackConfig.entry[e]],t),{})}reactRailsHotReloadConfig(){return{devtool:"cheap-eval-source-map",entry:this.entries(),output:{publicPath:"http://localhost:3035/packs/"},plugins:[new l.DefinePlugin({HMR_MODULES:JSON.stringify(this.packFiles())})],resolve:{alias:{"react-dom":"@hot-loader/react-dom"}},watch:!1}}merge(t){return this.webpackConfig=t,c(this.webpackConfig,this.reactRailsHotReloadConfig())}}module.exports=m;export{u as ReactRailsHotReload,m as ReactRailsHotReloadConfig};
//# sourceMappingURL=index.modern.js.map

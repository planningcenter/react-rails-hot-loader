import{AppContainer as t}from"react-hot-loader";import e from"react";import o from"react-dom";import r from"lodash";import{join as n,relative as i}from"path";import{readdirSync as a,statSync as c}from"fs";import{merge as s}from"webpack-merge";import u from"webpack";var p={},f={init:function(t,e){window.ReactRailsUJS.mountComponents=f.mountComponents,t.hot&&t.hot.accept(f.hmrModules(),function(t){f.fixDeps(t).forEach(function(t){return e(t)}),window.ReactRailsUJS.mountComponents()})},fixDeps:function(t){return r(t).flatten().uniq().value()},hmrModules:function(){return HMR_MODULES.map(function(t){return require.context("../").resolve(t)})},mountComponents:function(r){for(var n=window.ReactRailsUJS,i=n.findDOMNodes(r),a=0;a<i.length;++a){var c=i[a],s=c.getAttribute(n.CLASS_NAME_ATTR),u=n.getConstructor(s),f=c.getAttribute(n.PROPS_ATTR),l=f&&JSON.parse(f),m=c.getAttribute(n.RENDER_ATTR),h=c.getAttribute(n.CACHE_ID_ATTR),d=c.hasAttribute(n.TURBOLINKS_PERMANENT_ATTR);if(!u){var R="Cannot find component: '"+s+"'";throw console&&console.log&&console.log("%c[react-rails] %c"+R+" for element","font-weight: bold","",c),new Error(R+". Make sure your component is available to render.")}var g=p[h];void 0===g&&(g=e.createElement(u,l),d&&(p[h]=g)),m&&"function"==typeof o.hydrate?o.hydrate(e.createElement(t,{},g),c):o.render(e.createElement(t,{},g),c)}}},l=function(){function t(t){this.webpackConfig=t}var e=t.prototype;return e.walkSync=function(t,e){var o=this;return void 0===e&&(e=[]),a(t).forEach(function(r){var a=n(t,r);a.includes(".DS_Store")||a.includes("packs")||(c(a).isDirectory()?e=o.walkSync(a,e):e.push("./"+i("app/javascript",a)))}),e},e.packFiles=function(){return this.walkSync("app/javascript")},e.entries=function(){var t=this;return Object.keys(this.webpackConfig.entry).reduce(function(e,o){return e[o]=["react-hot-loader/patch",t.webpackConfig.entry[o]],e},{})},e.reactRailsHotReloadConfig=function(){return{devtool:"cheap-eval-source-map",entry:this.entries(),output:{publicPath:"http://localhost:3035/packs/"},plugins:[new u.DefinePlugin({HMR_MODULES:JSON.stringify(this.packFiles())})],resolve:{alias:{"react-dom":"@hot-loader/react-dom"}},watch:!1}},e.merge=function(t){return this.webpackConfig=t,s(this.webpackConfig,this.reactRailsHotReloadConfig())},t}();export{f as ReactRailsHotReload,l as ReactRailsHotReloadConfig};
//# sourceMappingURL=index.module.js.map
